---
permalink: sg6100/replace-controller-e4000-duplex.html 
sidebar: sidebar 
keywords:  
summary:  
---
= 更换E4000存储控制器(SG6160)
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果E4000控制器未以最佳状态运行或出现故障、您可能需要更换它。

.开始之前
* 您的更换控制器的部件号与要更换的控制器相同。
* 您可以通过标签来识别连接到控制器的每个缆线。
* 您已安装 ESD 腕带，或者已采取其他防静电预防措施。
* 您有一个 1 号十字螺丝刀。
* 您已在数据中心中找到要更换控制器的物理存储设备。



NOTE: 请勿依靠E系列说明来更换StorageGRID 设备中的控制器、因为更换过程不同。

.关于此任务
您可以通过以下两种方式确定控制器是否出现故障：

* 网格管理器警报指示存储控制器出现故障情况、而网格管理器或SANtricity系统管理器中的恢复专家会指示您更换控制器。
* 控制器上的琥珀色警示 LED 亮起，表示控制器出现故障。
+

NOTE: 如果磁盘架中的两个控制器的警示 LED 均亮起，请联系技术支持以获得帮助。



如果您的设备包含两个存储控制器、则只要满足以下条件、您就可以在设备启动并执行读/写操作时更换其中一个控制器：

* 磁盘架中的第二个控制器处于最佳状态。
* SANtricity 系统管理器中恢复 Guru 的详细信息区域中的 * 确定删除 * 字段显示 * 是 * ，表示删除此组件是安全的。



NOTE: 如果可能，请将设备置于此替代操作步骤 的维护模式，以最大限度地减少意外错误或故障的潜在影响。


NOTE: 如果磁盘架中的第二个控制器状态不是最佳、或者Recovery Guru指示无法删除此控制器、请联系技术支持。



== 第1步：准备更换用的控制器

准备更换用的E4000控制器。

.步骤
. 拆开新控制器的包装，将其放在无静电的平面上。
+
请保存包装材料，以便在运输故障控制器时使用。

. 在替代控制器的背面找到 MAC 地址和 FRU 部件号标签。




== 第2步：使控制器脱机

准备删除故障控制器并使其脱机。您可以使用SANtricity系统管理器执行这些步骤。

.步骤
. 确认故障控制器的更换部件号与更换控制器的 FRU 部件号相同。
+
如果控制器出现故障并需要更换，则更换部件号将显示在 Recovery Guru 的 Details 区域中。如果需要手动查找此数字，可以在 * 基础 * 选项卡上查看控制器。

+

CAUTION: *可能无法访问数据&#8212；*如果两个部件号不同，请勿尝试此操作步骤。

. 备份配置数据库。
+
如果删除控制器时出现问题，您可以使用保存的文件还原配置。系统将保存 RAID 配置数据库的当前状态，其中包括控制器上卷组和磁盘池的所有数据。

+
.. 选择*支持›支持中心›诊断*。
.. 选择 * 收集配置数据 * 。
.. 单击 * 收集 * 。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * configurationData-<arrayName>-<DateTime>.7z* 。



. 收集设备的支持数据。
+

NOTE: 在更换组件前后收集支持数据可确保在更换组件无法解决问题时、您可以向技术支持发送一整套日志。

+
如果删除控制器时出现问题，您可以使用保存的文件对问题描述进行故障排除。系统会将有关存储阵列的清单，状态和性能数据保存在一个文件中。

+
.. *选择支持›支持中心›诊断*。
.. 选择 * 收集支持数据 * 。
.. 单击 * 收集 * 。


. 使计划更换的控制器脱机。




== 步骤3：卸下控制器箱

拆下控制器箱。

.步骤
. 戴上 ESD 腕带或采取其他防静电预防措施。
. 为连接到控制器箱的每个缆线贴上标签。
. 断开控制器箱的所有缆线。
+

CAUTION: To prevent degraded performance, do not twist, fold, pinch, or step on the cables.

. 挤压凸轮把手上的闩锁、直到其释放、完全打开凸轮把手以从中板释放控制器箱、然后用两只手将控制器箱拉出机箱。
. 将控制器放在无静电的平面上，可拆卸盖朝上。
. 按下控制器箱两侧的蓝色按钮以松开护盖、然后向上旋转护盖、使其脱离控制器箱、从而打开护盖。




== 第4步：确定要传输到更换控制器的部件

更换用的控制器可能预装了部件。确定必须将哪些部件转移到更换用的控制器箱。

. 将更换用的控制器放在无静电的平坦表面上、可拆卸盖朝上。
. 按下控制器箱两侧的蓝色按钮以松开护盖、然后向上旋转护盖、使其脱离控制器箱、从而打开护盖。
. 确定更换用的控制器是否包含电池和(或) DIMM。如果安装了控制器护盖、请重新安装控制器护盖、然后转至 <<step8_replace_controller,第8步：更换控制器>>。否则：
+
** 如果更换用的控制器不包括电池或DIMM、请转至 <<step5_remove_battery,第5步：取出电池>>。
** 如果更换用的控制器包括电池、但不包括DIMM、请转至 <<step6_remove_dimm,第6步：移动DIMM>>。






== 第5步：取出电池

从受损控制器中取出电池、并在必要时将其安装在更换用的控制器中。

.步骤
. 从控制器箱中取出电池：
+
.. 按下控制器箱侧面的蓝色按钮。
.. 向上滑动电池、直至其脱离固定支架、然后将电池从控制器箱中提出。
.. 通过以下方法拔下电池插头：按压电池插头表面的夹子以从插座中释放电池插头、然后从插座中拔下电池电缆。
+
image::../media/drw_E4000_replace_nvbattery_IEOPS-862.png[卸下NVMEM电池。]

+
|===


 a| 
image::../media/legend_icon_01.png[图例图标 01]
| 电池释放卡舌 


 a| 
image::../media/legend_icon_02.png[legend icon 02]
| 电池电源连接器 
|===


. 将电池移至更换用的控制器箱并进行安装：
+
.. 将电池与金属板侧壁上的固定支架对齐、但不要将其连接。在将其余组件移至更换用的控制器箱后、您需要将其插入。


. 如果更换用的控制器预安装了DIMM、请转至 <<step7_install_battery,第7步：安装电池>>。否则、请继续下一步。




== 第6步：移动DIMM

从受损控制器箱中取出DIMM、然后将其安装到更换用的控制器箱中。

.步骤
. 找到控制器箱上的DIMM。
+

NOTE: 记下DIMM在插槽中的位置、以便可以按正确的方向将DIMM插入更换用的控制器箱中的同一位置。
从受损控制器箱中卸下DIMM：

+
.. 通过缓慢地拉开DIMM两侧的DIMM弹出卡舌、从插槽中弹出DIMM。
+
DIMM将向上旋转一点。

.. 将DIMM旋转到最远位置、然后将DIMM滑出插槽。
+

NOTE: Carefully hold the DIMM by the edges to avoid pressure on the components on the DIMM circuit board.

+
image::../media/drw_E4000_replace_dimms_IEOPS-865.png[取出DIMM。]

+
|===


 a| 
image::../media/legend_icon_01.png[图例图标 01]
| DIMM ejector tabs 


 a| 
image::../media/legend_icon_02.png[legend icon 02]
| DIMM 
|===


. 确认电池未插入更换用的控制器箱。
. 在替代控制器中将DIMM安装在受损控制器中的相同位置：
+
.. Push carefully, but firmly, on the top edge of the DIMM until the ejector tabs snap into place over the notches at the ends of the DIMM.
+
The DIMM fits tightly in the slot, but should go in easily.If not, realign the DIMM with the slot and reinsert it.

+

NOTE: Visually inspect the DIMM to verify that it is evenly aligned and fully inserted into the slot.



. 对另一个DIMM重复上述步骤。
. 如果更换用的控制器预装了电池、请转至 <<step8_replace_controller,第8步：更换控制器>>。否则、请继续下一步。




== 第7步：安装电池

将电池安装到更换用的控制器箱中。

.步骤
. 将蓄电池插头重新插入控制器箱上的插座。
+
确保插头锁定在主板上的电池插槽中。

. 将电池与金属板侧壁上的固定支架对齐。
. 向下滑动电池组、直至电池闩锁卡入到位并卡入侧壁的开口中。
. 重新安装控制器箱盖并将其锁定到位。




== 第8步：更换控制器

安装替代控制器并验证节点是否已重新加入网格。

.步骤
. 将替代控制器安装到设备中。
+
.. 将控制器翻转，使可拆卸盖朝下。
.. 在凸轮把手处于打开位置的情况下，将控制器完全滑入设备中。
.. 将凸轮把手移至左侧，将控制器锁定到位。
.. 更换缆线。
.. 如果原始控制器使用 DHCP 作为 IP 地址，请在替代控制器背面的标签上找到 MAC 地址。请您的网络管理员将您删除的控制器的 DNS/network 和 IP 地址与替代控制器的 MAC 地址相关联。
+

NOTE: 如果原始控制器未使用 DHCP 作为 IP 地址，则新控制器将采用您删除的控制器的 IP 地址。



. 使用 SANtricity 系统管理器使控制器联机：
+
.. 选择 * 硬件 * 。
.. 如果图中显示了驱动器，请选择*控制器和组件*。
.. 选择要置于联机状态的控制器。
.. 从上下文菜单中选择 * 置于联机状态 * ，然后确认要执行此操作。


. 在控制器启动时，检查控制器 LED 。
+
** 控制器上的琥珀色警示 LED 会亮起，然后熄灭，除非出现错误。
** 主机链路 LED 可能亮起，闪烁或熄灭，具体取决于主机接口。


. 控制器恢复联机后，确认其状态为最佳，并检查控制器架的警示 LED 。
+
如果状态不是最佳状态，或者任何警示 LED 均亮起，请确认所有缆线均已正确就位，并且控制器箱已正确安装。如有必要，请拆下并重新安装控制器箱。

+

NOTE: 如果无法解决此问题，请联系技术支持。

. 如果需要，请使用 SANtricity 系统管理器将所有卷重新分配给其首选所有者。
+
.. 选择*存储›卷*。
.. 选择*更多›重新分布卷*。


. 使用 SANtricity 系统管理器收集存储阵列的支持数据。
+
.. 选择*支持›支持中心›诊断*。
.. 选择 * 收集支持数据 * 。
.. 单击 * 收集 * 。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * support-data.7z* 。



. 如果您在此操作步骤期间将设备置于维护模式、请退出维护模式并等待节点重新启动并重新加入网格。此过程可能需要长达 20 分钟。然后、在网格管理器中、验证节点页面是否显示正常状态(绿色复选标记图标) image:../media/icon_alert_green_checkmark.png["绿色复选标记"] 节点名称左侧)、表示没有处于活动状态的警报、并且节点已连接到网格。
+
image::../media/nodes_menu.png[设备节点已重新加入网格]



.下一步是什么？
控制器更换已完成。您可以恢复正常操作。

更换部件后，按照套件随附的 RMA 说明将故障部件退回 NetApp 。请参见 https://mysupport.netapp.com/site/info/rma["部件退回和放大器；更换"^] 第页，了解更多信息。
