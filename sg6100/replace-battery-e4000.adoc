---
permalink: sg6100/replace-battery-e4000.html 
sidebar: sidebar 
keywords:  
summary:  
---
= 更换存储控制器架中的电池(SG6160)
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果SANtricity系统管理器中的Recovery Guru指示"电池出现故障"或"需要更换电池"状态、则必须更换E4000控制器中受影响的电池。为了保护您的数据、必须尽快更换电池。

在 SANtricity 系统管理器中，查看恢复 Guru 中的详细信息，确认问题描述具有电池，并确保不需要先解决任何其他问题。

.开始之前
如果您计划更换发生故障的电池，则必须：

* 更换电池。
* ESD 腕带，或者您已采取其他防静电预防措施。
* 用于标识连接到控制器箱的每个缆线的标签。
* 访问SANtricity系统管理器：
+
** 在网格管理器中，选择*NODE*>*_Appliance NODE_*> SANtricity System Manager*。控制器信息位于上 https://docs.netapp.com/us-en/storagegrid-118/monitor/viewing-santricity-system-manager-tab.html["SANtricity系统管理器选项卡"]。
** 将Management Station中的浏览器指向控制器的域名或IP地址。


* 验证是否未使用任何卷，或者是否已在使用这些卷的所有主机上安装多路径驱动程序。




== 步骤1：准备更换电池

您必须将受影响的控制器置于脱机状态、才能安全地取出发生故障的电池。未置于脱机状态的控制器必须处于联机状态（处于最佳状态）。

.步骤
. 在 SANtricity 系统管理器中，查看恢复 Guru 中的详细信息，确认问题描述具有电池，并确保不需要先解决任何其他问题。
. 从 Recovery Guru 的 Details 区域中，确定要更换的电池。
. 使用SANtricity系统管理器备份存储阵列的配置数据库。
+
如果删除控制器时出现问题，您可以使用保存的文件还原配置。系统将保存 RAID 配置数据库的当前状态，其中包括控制器上卷组和磁盘池的所有数据。

+
** 在 System Manager 中：
+
... 选择*支持›支持中心›诊断*。
... 选择 * 收集配置数据 * 。
... 单击 * 收集 * 。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * configurationData-<arrayName>-<DateTime>.7z* 。



** 或者，您也可以使用以下命令行界面命令备份配置数据库：
+
`save storageArray dbmDatabase sourceLocation=onboard contentType=all file="filename";`



. 使用 SANtricity 系统管理器收集存储阵列的支持数据。
. 如果删除控制器时出现问题，您可以使用保存的文件对问题描述进行故障排除。系统会将有关存储阵列的清单，状态和性能数据保存在一个文件中。
+
.. 选择*支持›支持中心›诊断*。
.. 选择 * 收集支持数据 * 。
.. 单击 * 收集 * 。
+
文件将保存在浏览器的"Downloads"文件夹中、名称为support-data.7z。



. 如果控制器尚未脱机，请立即使用 SANtricity 系统管理器将其脱机。
+
** 在 SANtricity 系统管理器中：
+
... 选择 * 硬件 * 。
... 如果图形显示了驱动器，请选择 * 显示磁盘架背面 * 以显示控制器。
... 选择要置于脱机状态的控制器。
... 从上下文菜单中，选择 * 置于脱机状态 * ，然后确认要执行此操作。
+

NOTE: 如果您正在使用尝试脱机的控制器访问 SANtricity 系统管理器，则会显示 SANtricity 系统管理器不可用消息。选择 * 连接到备用网络连接 * 以使用另一个控制器自动访问 SANtricity 系统管理器。



** 或者，您也可以使用以下命令行界面命令使控制器脱机：
+
*对于控制器A*： `set controller [a] availability=offline`

+
*对于控制器B*： `set controller [b] availability=offline`



. 等待SANtricity系统管理器将控制器的状态更新为脱机。
. 从Recovery Guru中选择*重新检查*，并确认*详细信息*区域中的*确定删除*字段显示*是*。这表示可以安全地继续卸下控制器箱。




== 步骤2：卸下E4000控制器箱

您需要从控制器架中取出控制器箱，以便取出电池。

.开始之前
确保您已具备以下条件：

* ESD 腕带，或者您已采取其他防静电预防措施。
* 用于标识连接到控制器箱的每个缆线的标签。


.步骤
. 断开控制器箱的所有缆线。
+

CAUTION: To prevent degraded performance, do not twist, fold, pinch, or step on the cables.

. 如果控制器箱上的主机端口使用 SFP+ 收发器，请保持安装状态。
. 确认控制器背面的缓存活动 LED 是否熄灭。
. 挤压凸轮把手上的闩锁、直到其释放、完全打开凸轮把手以从中间板释放控制器箱、然后用双手将控制器箱从机箱中拉出一半。




== 第3步：安装新电池

您必须取出故障电池并进行更换。

.步骤
. 拆开新电池的包装、将其放在无静电的平坦表面上。
+

NOTE: 为了安全地遵守 IATA 规定，更换电池在发货时的荷电状态（ SoC ）不超过 30% 。重新接通电源时，请记住，在更换电池电量已满且其完成初始学习周期之前，写入缓存不会恢复。

. 如果您尚未接地，请正确接地。
. 从机箱中卸下控制器箱。
. 翻转控制器箱、将其放在平坦、稳定的表面上。
. 按下控制器箱两侧的蓝色按钮以松开护盖、然后向上旋转护盖、使其脱离控制器箱、从而打开护盖。
+
image::../media/drw_E4000_open_controller_module_cover_IEOPS-870.png[打开控制器模块护盖。]

. 在控制器箱中找到电池。
. 从控制器箱中取出发生故障的电池：
+
.. 按下控制器箱侧面的蓝色按钮。
.. 向上滑动电池、直至其脱离固定支架、然后将电池从控制器箱中提出。
.. 从控制器箱中拔下电池。
+
image::../media/drw_E4000_replace_nvbattery_IEOPS-862.png[卸下NVMEM电池。]

+
|===


 a| 
image::../media/legend_icon_01.png[图例图标 01]
| 电池释放卡舌 


 a| 
image::../media/legend_icon_02.png[legend icon 02]
| 电池电源连接器 
|===


. Remove the replacement battery from its package.安装更换电池：
+
.. 将蓄电池插头重新插入控制器箱上的插座。
+
确保插头锁定在主板上的电池插槽中。

.. 将电池与金属板侧壁上的固定支架对齐。
.. 向下滑动电池组、直至电池闩锁卡入到位并卡入侧壁的开口中。


. 重新安装控制器箱盖并将其锁定到位。




== 第 4 步：重新安装控制器箱

更换控制器箱中的组件后、将其重新安装到机箱中。

.步骤
. 如果您尚未接地，请正确接地。
. 如果尚未更换控制器箱上的盖子、请进行更换。
. 翻转控制器箱、并将其端部与机箱中的开口对齐。
. 将控制器箱的末端与机箱中的开口对齐、然后将控制器箱轻轻推入系统的一半。
+

NOTE: 在系统指示之前、请勿将控制器箱完全插入机箱中。

. Recable the system, as needed.
. 完成控制器箱的重新安装：
+
.. 使凸轮把手处于打开位置、用力推入控制器箱、直到它与中板接触并完全就位、然后将凸轮把手合上至锁定位置。
+

NOTE: 将控制器箱滑入机箱时、请勿用力过度、以免损坏连接器。

+
The controller begins to boot as soon as it is seated in the chassis.

.. If you have not already done so, reinstall the cable management device.
.. 使用钩环带将缆线绑定到缆线管理设备。






== 第5步：完成电池更换

将控制器置于联机状态。

.步骤
. 使用 SANtricity 系统管理器使控制器联机。
+
** 在 SANtricity 系统管理器中：
+
... 选择 * 硬件 * 。
... 如果图形显示了驱动器，请选择 * 显示磁盘架背面 * 。
... 选择要置于联机状态的控制器。
... 从上下文菜单中选择 * 置于联机状态 * ，然后确认要执行此操作。
+
系统将控制器置于联机状态。



** 或者，您也可以使用以下命令行界面命令将控制器重新联机：
+
*对于控制器A*： `set controller [a] availability=online`；

+
*对于控制器B*： `set controller [b] availability=online`；



. 控制器恢复联机后、检查控制器架的警示LED。
+
如果状态不是最佳状态或任何警示 LED 均亮起，请确认所有缆线均已正确就位，并检查电池和控制器箱是否已正确安装。如有必要，请拆下并重新安装控制器箱和电池。

+

NOTE: 如果无法解决此问题，请联系技术支持。
如果需要，请使用 SANtricity 系统管理器收集存储阵列的支持数据。

. 验证所有卷是否均已返回到首选所有者。
+
.. 选择*存储›卷*。在 * 所有卷 * 页面中，验证卷是否已分发到其首选所有者。选择*更多›更改所有权*以查看卷所有者。
.. 如果所有卷均归首选所有者所有、请继续执行步骤4。
.. 如果未返回任何卷，则必须手动返回这些卷。转到*更多›重新分发卷*。
.. 如果在自动分发或手动分发之后只有部分卷返回给其首选所有者、则必须检查Recovery Guru以了解主机连接问题。
.. 如果不存在Recovery Guru、或者在执行Recovery Guru步骤后、卷仍未返回到其首选所有者、请联系支持部门。


. 使用 SANtricity 系统管理器收集存储阵列的支持数据。
+
.. 选择*支持›支持中心›诊断*。
.. 选择收集支持数据。
.. 单击收集。
+
文件将保存在浏览器的"Downloads"文件夹中、名称为support-data.7z。





.下一步是什么？
您的电池更换已完成。您可以恢复正常操作。
